Влетаю в уходящие двери закрывающегося поезда.
Проект более чем не идеальный, я знаю.
Более того, я считаю визуальную оценку корреляции параметров не слишком допустимой, но адаптировать формулы тестов под своё нынешнее понимание решения я уже не мог.
Функции, которые я прописал, тяжеловесны и местами костыльны (не выбрасывайте швабры!), но придумывать лучше... вы поняли.

Но любой сданный проект лучше несданного идеального.
За сим откланяюсь.

P.S. Уже залив на гит я думаю, что а можно было вот так попробовать или даже ВОТ ТАК, но чёрт с ним.